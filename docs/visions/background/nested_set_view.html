

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Nested set view &mdash; visions 0.4.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Graph view" href="graph_view.html" />
    <link rel="prev" title="Theory" href="theory.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> visions
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/extending.html">Extending</a></li>
</ul>
<p class="caption"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../applications/applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/summarizer.html">Data Summarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/validation.html">Data Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/machine_learning.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/compression.html">Data Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/integration.html">Data Discovery and Data Integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Contribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/contributing.html">Community contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/type.html">Contributions new types to visions</a></li>
</ul>
<p class="caption"><span class="caption-text">Background</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Nested set view</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_view.html">Graph view</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">visions</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Nested set view</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/visions/background/nested_set_view.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nested-set-view">
<h1>Nested set view<a class="headerlink" href="#nested-set-view" title="Permalink to this headline">Â¶</a></h1>
<p>Sets are an excellent way to reason about types, as the definition of a type is literally constraining the possible values the data can have. We find this view intuitive to create understanding of where the the exclusivity constraint in membership relation comes from, but it is limited in understanding relational mappings (see the graph view).</p>
<p>Below we see a <a class="reference external" href="https://en.wikipedia.org/wiki/Circle_packing">circle packing</a> representation of the data types in the complete set.
Each circle represents the subset of all possible values that is denoted as that type.
For example, the boolean type has the possible values <span class="math notranslate nohighlight">\(\{True, False, None\}\)</span>.
There is one root type, <cite>Generic</cite>, of which represents all possible values.</p>
<p>When we perform type inference of a set of values, we find the narrowest circle that contains all values.
For example, a set <span class="math notranslate nohighlight">\(\{'2020-01-01', '2020-02-02'\}\)</span> is a member of <cite>Generic</cite>, <cite>DateTime</cite> and <cite>Date</cite>.
<cite>Date</cite> is the narrowest circle, hence the type.
Similarly, the membership relation is true when the circle includes all values.</p>
<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
    <meta charset="utf-8">
    <style>
        .node {
            cursor: pointer;
        }

        .node:hover {
            stroke: #000;
            stroke-width: 1.5px;
        }

        .node--leaf {
            fill: white;
        }

        .label {
            font: 11px "Helvetica Neue", Helvetica, Arial, sans-serif;
            text-anchor: middle;
            text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, -1px 0 0 #fff, 0 -1px 0 #fff;
        }

        .label,
        .node--root,
        .node--leaf {
            pointer-events: none;
        }

    </style>
</head>
<body>
<svg width="700" height="700"></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>
    var svg = d3.select("svg"),
        margin = 20,
        diameter = svg.attr("width"),
        g = svg.append("g").attr("transform", "translate(" + diameter / 2 + "," + diameter / 2 + ")");

    var color = d3.scaleLinear()
        .domain([-1, 5])
        .range(["hsl(204, 64%, 44%)", "hsl(204, 65%, 90%)"])
        .interpolate(d3.interpolateHcl);

    var pack = d3.pack()
        .size([diameter - margin, diameter - margin])
        .padding(30);

    // d3.json("typesets/typeset_complete_base.json", function (error, root) {
    //    if (error) throw error;
    // START-REPLACE
	root = {"children": [{"name": "Boolean", "size": 1}, {"children": [{"name": "Ordinal", "size": 1}], "name": "Categorical"}, {"name": "Complex", "size": 1}, {"name": "Count", "size": 1}, {"children": [{"name": "Date", "size": 1}, {"name": "Time", "size": 1}], "name": "DateTime"}, {"name": "Float", "size": 1}, {"name": "Integer", "size": 1}, {"children": [{"name": "Geometry", "size": 1}, {"name": "IPAddress", "size": 1}, {"children": [{"children": [{"name": "Image", "size": 1}], "name": "File"}], "name": "Path"}, {"name": "String", "size": 1}, {"name": "URL", "size": 1}, {"name": "UUID", "size": 1}], "name": "Object"}, {"name": "TimeDelta", "size": 1}], "name": "Generic"};
	// END-REPLACE
        root = d3.hierarchy(root)
            .sum(function (d) {
                return d.size;
            })
            .sort(function (a, b) {
                return b.size - a.size;
            });

        var focus = root;
        var view;

        var nodes = d3.select('svg g')
          .selectAll('g')
          .data(pack(root).descendants())
          .enter()
          .append('g')
          .attr('transform', function(d) {return 'translate(' + [d.x, d.y] + ')'})
            .on("click", function (d) {
                if (focus !== d) {
                    zoom(d);
                    d3.event.stopPropagation();
                }
            });

        nodes
          .append('circle')
          .attr("class", function (d) {
                return d.parent ? d.children ? "node" : "node node--leaf" : "node node--root";
          })
          .style("fill", function (d) {
                return d.children ? color(d.depth) : null;
          })
          .attr('r', function(d) { return d.r; });

        nodes
          .append('text')
            .attr('y', function(d){
                var parent = d3.select(this.parentNode);
                var c = parent.select('circle');

                return d.children ? - 0.95 * c.attr("r") + 10 : 0;
            })
          .attr("class", "label")
            .style('font-size', function(d){
                var parent = d3.select(this.parentNode);
                var c = parent.select('circle');
                return Math.round(8 + 0.75 * c.attr('r') / 10).toString() + 'px';
            })
          .text(function(d) {
              return d.data.name;
          });

        var node = g.selectAll("g");
        var circle = g.selectAll("circle");
        var text = g.selectAll("text");

        svg
            .on("click", function () {
                zoom(root);
            });

        zoomTo([root.x, root.y, root.r * 2 + margin]);

        function zoom(d) {
            var focus0 = focus;
            focus = d;

            var transition = d3.transition()
                .duration(d3.event.altKey ? 7500 : 750)
                .tween("zoom", function (d) {
                    var i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2 + margin]);
                    return function (t) {
                        zoomTo(i(t));
                    };
                });
        }

        function zoomTo(v) {
            var k = diameter / v[2];
            view = v;

            node.attr("transform", function (d) {
                return "translate(" + (d.x - v[0]) * k + "," + (d.y - v[1]) * k + ")";
            });

            circle.attr("r", function (d) {
                return d.r * k;
            });

            text.attr("y", function(d){
                var parent = d3.select(this.parentNode);
                var c = parent.select('circle');

                return d.children ? - 0.95 * c.attr("r") + 10 : 0;
            });
        }
    //});
</script>
</body>
</html><p class="caption">
    <span class="caption-text"><a href="https://bl.ocks.org/fdlk/076469462d00ba39960f854df9acda56">Circle packing</a> of the <em>CompleteSet</em>.</span>
    <a class="headerlink" href="#id1" title="Permalink to this image">
    </a>
</p></div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="graph_view.html" class="btn btn-neutral float-right" title="Graph view" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="theory.html" class="btn btn-neutral float-left" title="Theory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ian Eaves and Simon Brugman

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>